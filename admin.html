<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ðŸŽ¸ Admin â€“ MobyDick</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">

<style>
:root{
  --bg:#0f1115;
  --panel:#181b22;
  --accent:#d4af37;
  --text:#f1f1f1;
  --muted:#9aa0a6;
}

body{
  background:var(--bg);
  color:var(--text);
  font-family:system-ui, -apple-system, BlinkMacSystemFont;
}

.header{
  display:flex;
  align-items:center;
  gap:12px;
  margin-bottom:12px;
}

.header img{
  height:36px;
}

.nav-tabs{
  border:none;
  gap:8px;
}

.nav-tabs .nav-link{
  background:var(--panel);
  color:var(--muted);
  border:none;
  border-radius:14px;
  padding:10px 16px;
  font-weight:600;
}

.nav-tabs .nav-link.active{
  background:var(--accent);
  color:#000;
}

.card{
  background:var(--panel);
  border:none;
  border-radius:18px;
  margin-bottom:12px;
}

.song-row{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:12px;
}

.song-title{
  font-weight:700;
  font-size:1.05rem;
}

.song-artist{
  font-size:.85rem;
  color:var(--muted);
}

.vote{
  background:var(--accent);
  color:#000;
  font-weight:800;
  padding:6px 12px;
  border-radius:12px;
  min-width:48px;
  text-align:center;
}

.fixed-add{
  position:fixed;
  right:18px;
  bottom:18px;
  width:64px;
  height:64px;
  border-radius:50%;
  font-size:1.8rem;
  z-index:1000;
}
</style>
</head>

<body>

<div class="container py-3">

  <!-- HEADER -->
  <div class="header">
    <img src="logo_new.png" alt="MobyDick">
    <h4 class="m-0">Admin â€“ MobyDick</h4>
  </div>

  <!-- TABS -->
  <ul class="nav nav-tabs mb-3">
    <li class="nav-item">
      <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#votadas">ðŸŽ¶ Votadas</button>
    </li>
    <li class="nav-item">
      <button class="nav-link" data-bs-toggle="tab" data-bs-target="#playlist">ðŸ“œ Playlist</button>
    </li>
    <li class="nav-item">
      <button class="nav-link" data-bs-toggle="tab" data-bs-target="#mensajes">ðŸ’¬ Mensajes</button>
    </li>
    <li class="nav-item">
      <button class="nav-link" data-bs-toggle="tab" data-bs-target="#sugerencias">âž• Sugerencias</button>
    </li>
  </ul>

  <div class="tab-content">

    <div class="tab-pane fade show active" id="votadas">
      <div id="songsList"></div>
    </div>

    <div class="tab-pane fade" id="playlist">
      <div id="playlistList"></div>
    </div>

    <div class="tab-pane fade" id="mensajes">
      <div id="messagesList"></div>
    </div>

    <div class="tab-pane fade" id="sugerencias">
      <div id="suggestionsList"></div>
    </div>

  </div>
</div>

<!-- BOTÃ“N AGREGAR -->
<button class="btn btn-success fixed-add" data-bs-toggle="modal" data-bs-target="#addSongModal">
  <i class="bi bi-plus"></i>
</button>

<!-- MODAL -->
<div class="modal fade" id="addSongModal">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content bg-dark text-light">
      <div class="modal-header border-0">
        <h5>Agregar canciÃ³n</h5>
        <button class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <input id="songName" class="form-control mb-2" placeholder="CanciÃ³n">
        <input id="songArtist" class="form-control" placeholder="Artista">
      </div>
      <div class="modal-footer border-0">
        <button class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
        <button class="btn btn-success" onclick="addSong()">Agregar</button>
      </div>
    </div>
  </div>
</div>

<!-- FIREBASE -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyAitXyfb6Zc9GVEm0X_Hen_QOiA5Y3Aw1U",
  authDomain: "rockrequests.firebaseapp.com",
  projectId: "rockrequests",
  storageBucket: "rockrequests.firebasestorage.app",
  messagingSenderId: "1000216858616",
  appId: "1:1000216858616:web:00bbd448eb034cba15d00d"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

// === CANCIONES VOTADAS ===
db.collection("songs").orderBy("votes","desc")
.onSnapshot(snap=>{
  songsList.innerHTML="";
  snap.forEach(doc=>{
    const s=doc.data();
    songsList.innerHTML+=`
    <div class="card p-3">
      <div class="song-row">
        <div>
          <div class="song-title">${s.name}</div>
          <div class="song-artist">${s.artist}</div>
        </div>
        <div class="vote">${s.votes||0}</div>
      </div>
    </div>`;
  });
});

// === MENSAJES ===
db.collection("messages").onSnapshot(snap=>{
  messagesList.innerHTML="";
  snap.forEach(d=>{
    messagesList.innerHTML+=`
    <div class="card p-3">${d.data().text||""}</div>`;
  });
});

// === SUGERENCIAS ===
db.collection("temporary_data").onSnapshot(snap=>{
  suggestionsList.innerHTML="";
  snap.forEach(d=>{
    suggestionsList.innerHTML+=`
    <div class="card p-3">${d.data().song||""}</div>`;
  });
});

// === AGREGAR CANCIÃ“N ===
function addSong(){
  if(!songName.value||!songArtist.value)return;
  db.collection("songs").add({
    name:songName.value,
    artist:songArtist.value,
    votes:0
  });
  songName.value="";
  songArtist.value="";
  bootstrap.Modal.getInstance(addSongModal).hide();
}
</script>

</body>
</html>
